{
  "entities": {
    "Income": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Income",
      "type": "object",
      "description": "Represents a daily income record.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the income record."
        },
        "date": {
          "type": "string",
          "description": "The date the income was received.",
          "format": "date-time"
        },
        "amountReceived": {
          "type": "number",
          "description": "The amount of income received."
        },
        "fuelExpenseId": {
          "type": "string",
          "description": "Reference to FuelExpense. (Relationship: Income 1:1 FuelExpense)"
        }
      },
      "required": [
        "id",
        "date",
        "amountReceived"
      ]
    },
    "FuelExpense": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "FuelExpense",
      "type": "object",
      "description": "Represents a fuel expense record.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the fuel expense record."
        },
        "date": {
          "type": "string",
          "description": "The date the fuel expense was incurred.",
          "format": "date-time"
        },
        "amount": {
          "type": "number",
          "description": "The amount of the fuel expense."
        }
      },
      "required": [
        "id",
        "date",
        "amount"
      ]
    },
    "HomeExpense": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "HomeExpense",
      "type": "object",
      "description": "Represents a household expense record.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the home expense record."
        },
        "date": {
          "type": "string",
          "description": "The date the expense was incurred.",
          "format": "date-time"
        },
        "category": {
          "type": "string",
          "description": "The category of the expense (Food, Electricity, Rent, etc.)."
        },
        "amount": {
          "type": "number",
          "description": "The amount of the expense."
        },
        "notes": {
          "type": "string",
          "description": "Optional notes about the expense."
        }
      },
      "required": [
        "id",
        "date",
        "category",
        "amount"
      ]
    },
    "Emi": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Emi",
      "type": "object",
      "description": "Represents an EMI (Equated Monthly Installment) record.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the EMI record."
        },
        "emiName": {
          "type": "string",
          "description": "The name of the EMI (e.g., Scooty Finance, Van Finance)."
        },
        "vehicleType": {
          "type": "string",
          "description": "The type of vehicle the EMI is for."
        },
        "monthlyEmiAmount": {
          "type": "number",
          "description": "The amount of the monthly EMI payment."
        },
        "totalMonths": {
          "type": "number",
          "description": "The total number of months for the EMI."
        },
        "startDate": {
          "type": "string",
          "description": "The start date of the EMI.",
          "format": "date-time"
        },
        "emiPaymentIds": {
          "type": "array",
          "description": "References to EmiPayment. (Relationship: Emi 1:N EmiPayment)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "emiName",
        "vehicleType",
        "monthlyEmiAmount",
        "totalMonths",
        "startDate"
      ]
    },
    "EmiPayment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "EmiPayment",
      "type": "object",
      "description": "Represents an EMI Payment record.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the EMI payment record."
        },
        "date": {
          "type": "string",
          "description": "The date the payment was made.",
          "format": "date-time"
        },
        "amount": {
          "type": "number",
          "description": "The amount of the payment."
        },
        "emiId": {
          "type": "string",
          "description": "Reference to Emi. (Relationship: Emi 1:N EmiPayment)"
        }
      },
      "required": [
        "id",
        "date",
        "amount",
        "emiId"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/incomes/{incomeId}",
        "definition": {
          "entityName": "Income",
          "schema": {
            "$ref": "#/backend/entities/Income"
          },
          "description": "Stores income records for a specific user. Path-based ownership ensures only the user can access their own income data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "incomeId",
              "description": "The unique identifier of the income record."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/fuel_expenses/{fuelExpenseId}",
        "definition": {
          "entityName": "FuelExpense",
          "schema": {
            "$ref": "#/backend/entities/FuelExpense"
          },
          "description": "Stores fuel expense records for a specific user. Path-based ownership ensures only the user can access their own fuel expense data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "fuelExpenseId",
              "description": "The unique identifier of the fuel expense record."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/home_expenses/{homeExpenseId}",
        "definition": {
          "entityName": "HomeExpense",
          "schema": {
            "$ref": "#/backend/entities/HomeExpense"
          },
          "description": "Stores home expense records for a specific user. Path-based ownership ensures only the user can access their own home expense data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "homeExpenseId",
              "description": "The unique identifier of the home expense record."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/emis/{emiId}",
        "definition": {
          "entityName": "Emi",
          "schema": {
            "$ref": "#/backend/entities/Emi"
          },
          "description": "Stores EMI records for a specific user. Path-based ownership ensures only the user can access their own EMI data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "emiId",
              "description": "The unique identifier of the EMI record."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/emis/{emiId}/emi_payments/{emiPaymentId}",
        "definition": {
          "entityName": "EmiPayment",
          "schema": {
            "$ref": "#/backend/entities/EmiPayment"
          },
          "description": "Stores EMI payment records for a specific user under a specific EMI. Path-based ownership ensures only the user can access their own EMI payment data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "emiId",
              "description": "The unique identifier of the EMI record."
            },
            {
              "name": "emiPaymentId",
              "description": "The unique identifier of the EMI payment record."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to organize and secure the financial data for the Family Finance Tracker application. It emphasizes path-based ownership for user-specific data, ensuring that each user (family member) can only access their own financial records.  Authorization Independence is achieved by storing all financial records (Income, FuelExpense, HomeExpense, Emi, and EmiPayment) under the user's document, eliminating the need for complex `get()` calls in security rules. This approach also supports QAPs by allowing secure list operations within each user's collection. The structure avoids custom claims (DBAC), relying solely on `request.auth.uid` and path-based ownership for authorization."
  }
}